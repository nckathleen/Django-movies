def import_users():
    import csv
    import json

    users = []

    field_names = 'UserID::Gender::Age::Occupation::Zip-code'

    with open(ml_dir + '/users.dat') as f:
        reader = csv.DictReader([line.replace("::", '\t') for line in f],
                                fieldnames=field_names.split('::'),
                                delimiter='\t')
        for row in reader:
            while True:
                email = fake.email()
                if User.objects.filter(username=email):
                    continue
                else:
                    break
            auth_user = User.objects.create_user(username=email,
                                                 email=email,
                                                 password=make_password('password'),
                                                 first_name=fake.first_name(),
                                                 last_name=fake.last_name())

            user = {'fields': {'gender': row['Gender'],
                               'age_group': row['Age'],
                               'occupation': row['Occupation'],
                               'zipcode': row['Zip-code']},
                    'model': 'moviedata.Rater',
                    'pk': auth_user.pk}
            users.append(user)
            auth_user.save()

    with open('moviedata/fixtures/users.json', 'w') as f:
        f.write(json.dumps(users))
